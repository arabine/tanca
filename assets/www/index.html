<!DOCTYPE html>
<html>
<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">

	<link href="css/tancafonts.css" rel="stylesheet">
	<link href="css/vuetify.min.css" rel="stylesheet">
  
</head>
<body>
  <div id="app">
	<v-app id="inspire" dark>

      <v-snackbar
      v-model="alert"
      top
      :color="alertType"
      :timeout="alertTimeout"
    >
    {{ alertText }}
    </v-snackbar>
    
		<v-toolbar>

			<v-toolbar-title>Tanca</v-toolbar-title>
			<v-spacer></v-spacer>
			<v-btn icon>
				<v-icon>refresh</v-icon>
			</v-btn>
			<v-btn icon>
				<v-icon>backup</v-icon>
			</v-btn>
		</v-toolbar>

		<v-content>
			<v-container fluid fill-height>
					<router-view></router-view>					
			</v-container>
		</v-content>

		<v-bottom-nav :active.sync="bottomNav" :value="true" absolute	color="transparent">

      <v-btn color="teal" flat value="home" to="home">
          <span>Home</span>
          <v-icon>home</v-icon>
      </v-btn>

			<v-btn color="teal" flat value="players" to="players">
				<span>Players</span>
				<v-icon>face</v-icon>
			</v-btn>

			<v-btn color="teal" flat value="teams" to="teams">
				<span>Teams</span>
				<v-icon>group</v-icon>
			</v-btn>
		
			<v-btn color="teal" flat value="games" to="games">
				<span>Games</span>
				<v-icon>casino</v-icon>
			</v-btn>
		
			<v-btn color="teal" flat value="results" to="results">
				<span>Results</span>
				<v-icon>assignment</v-icon>
			</v-btn>
		</v-bottom-nav>

	</v-app>

  </div>

  <script src="lib/vue.js"></script>
	<script src="lib/vuex.js"></script>
	<script src="lib/vuetify.js"></script>
	<script src="lib/vue-router.js"></script>
	<script src="lib/pouchdb.min.js"></script>
	<script src="lib/blossom.js"></script>

	<script src="backend.js"></script>
	<script src="components/AddPlayerDialog.js"></script>
  <script src="views/HomeView.js"></script>
  <script src="views/PlayersView.js"></script>
  <script src="views/TeamsView.js"></script>
  <script src="views/GamesView.js"></script>
  <script src="views/ResultsView.js"></script>
	<script src="app.js"></script>

<script>
var availablePlayers = [{
  "playerIndex": 1,
  "playerName": "Gérard",
  "points": 13,
  "opponents": [7]
}, {
  "playerIndex": 2,
  "playerName": "Philippe",
  "points": 13,
  "opponents": [8]
}, {
  "playerIndex": 3,
  "playerName": "Patrick",
  "points": 13,
  "opponents": [6]
}, {
  "playerIndex": 4,
  "playerName": "Jean",
  "points": 13,
  "opponents": [5]
}, {
  "playerIndex": 5,
  "playerName": "Anthony",
  "points": 4,
  "opponents": [4]
}, {
  "playerIndex": 6,
  "playerName": "Cathy",
  "points": 7,
  "opponents": [3]
}, {
  "playerIndex": 7,
  "playerName": "Fabienne",
  "points": 2,
  "opponents": [1]
}, {
  "playerIndex": 8,
  "playerName": "Élizabeth",
  "points": 11,
  "opponents": [2]
}]

var config = {
	pointsWin: 13
}

var roundIndex = 1;


var maxDiff = (roundIndex) * config.pointsWin;
/*
1  7  :  13  2
2  8  :  13  11
3  6  :  13  7
4  5  :  13  4
*/
  var possiblePairs = [];

  
  availablePlayers.forEach(player => {
    availablePlayers.forEach(opponent => {
      if (player.playerIndex !== opponent.playerIndex // &&
        // player.opponents.indexOf(opponent.playerIndex) === -1
      ) {
        var match = [player.playerIndex, opponent.playerIndex]
        match.sort(function(a, b) {
          return a - b;
        })
        if (player.opponents.indexOf(opponent.playerIndex) === -1) {
          match.push(maxDiff - Math.abs(player.points - opponent.points))
        }
        else {
          match.push(0)
        }
//        if (this.searchForArray(possiblePairs, match) === -1) {
          possiblePairs.push(match)
//        }
      }
    })
  })

 var round = {
	matches: []
  }

  var blossom = new Edmonds(possiblePairs, true);

  var rawPairing = blossom.maxWeightMatching();
  rawPairing.forEach((match, index) => {
    if (match !== -1 && match < index) {
      
      console.log(this.availablePlayers[index-1].playerName + " <> " + this.availablePlayers[match-1].playerName);

    }
  })


</script>


</body>
</html>